<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.qcap.cac.dao.WarehouseEntryMapper">

    <!--查詢入庫列表-->
    <select id="getWarehouseEntryList" resultType="java.util.Map" parameterType="com.qcap.cac.dto.WarehouseEntrySearchParam">
        select
        WAREHOUSE_ENTRY_ID,
        a.STOREROOM_ID,
        a.STOREROOM,
        ENTRY_BATCH_NO,
        b.GOODS_NO,
        b.GOODS_NAME,
        b.SUPPLIER_NAME,
        b.GOODS_TYPE,
        a.WAREHOUSE_STOCK_ID,
        a.ENTRY_NUM,
        a.ENTRY_UNIT,
        SUM_NUM,
        MIN_UNIT,
        DATE(a.ENTRY_TIME) entryTime,
        b.REMARK
        from tb_warehouse_entry a
        left join tb_warehouse_stock b
        on a.WAREHOUSE_STOCK_ID = b.WAREHOUSE_STOCK_ID
        where 1 = 1 AND a.DELETE_FLAG = 'N'
        <if test="storeroomId!=null and storeroomId!=''">
            and a.STOREROOM_ID = #{storeroomId}
        </if>
        <if test="entryBatchNo!=null and entryBatchNo!=''">
            and a.ENTRY_BATCH_NO like concat('%',#{entryBatchNo},'%')
        </if>
        <if test="goodsNo!=null and goodsNo!=''">
            and b.GOODS_NO like concat('%',#{goodsNo},'%')
        </if>
        <if test="goodsName!=null and goodsName!=''">
            and b.GOODS_NAME like  concat('%',#{goodsName},'%')
        </if>
        <if test="startDate!=null and startDate!=''">
            and DATE(a.ENTRY_TIME) &gt;= #{startDate}
        </if>
        <if test="endDate!=null and endDate!=''">
            and DATE(a.ENTRY_TIME) &lt;= #{endDate}
        </if>
        <if test="supplierName!=null and supplierName!=''">
            and b.SUPPLIER_NAME like concat('%',#{supplierName},'%')
        </if>
        order by a.ENTRY_TIME DESC,b.GOODS_NO ASC
    </select>

    <select id="getStoreRoomList" resultType="Map">
        select
        AREA_ID id,
        AREA_NAME text
        from tb_area
        where AREA_TYPE = "WAREHOUSE"
    </select>
</mapper>
