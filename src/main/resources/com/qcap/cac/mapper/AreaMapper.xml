<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.qcap.cac.dao.AreaMapper">


	<!--查询区域列表-->
	<select id="selectAreaList" resultType="Map" parameterType="String">
		<!--SELECT
		AREA_ID,
		AREA_CODE,
		AREA_NAME,
		AREA_TYPE,
		SUPER_AREA_CODE pAreaCode,
		(select AREA_NAME from tb_area a where a.AREA_CODE = b.SUPER_AREA_CODE) pAreaName,
		LEVEL,
		SEQ_NO,
		FINAL_FLAG,
		BUILDING_PURPOSE,
		BUILDING_CODE,
		ROOM_CODE,
		DOOR_CODE,
		ROOM_NO,
		ROOM_AREA,
		ACREAGE,
		PERIMETER,
		REMARK1
		FROM tb_area
		WHERE 1 = 1-->
		SELECT
		t.AREA_ID,
		t.AREA_CODE,
		t.AREA_NAME areaName,
		t.AREA_TYPE,
		t.SUPER_AREA_CODE pAreaCode,
		b.AREA_NAME pAreaName,
		t.BUILDING_PURPOSE,
		t.REMARK1
		FROM
		(SELECT
		AREA_ID,
		AREA_CODE,
		AREA_NAME,
		AREA_TYPE,
		SUPER_AREA_CODE,
		BUILDING_PURPOSE,
		SEQ_NO,
		LEVEL,
		REMARK1
		FROM tb_area where  1 = 1
		<if test="areaCode!=null and areaCode!=''">
			and (AREA_CODE = #{areaCode}
			OR SUPER_AREA_CODE = #{areaCode})
		</if>
		) t
		LEFT JOIN tb_area b
		on t.SUPER_AREA_CODE = b.AREA_CODE
		GROUP BY t.AREA_ID
		ORDER BY t.LEVEL,t.SEQ_NO
	</select>


	<!--查询区域树列表-->
	<select id="initTree" resultType="Map" >
		SELECT
		m.AREA_CODE areaCode,
		m.AREA_NAME areaName,
		m.SUPER_AREA_CODE pAreaCode,
		n.AREA_NAME pAreaName
		FROM
		tb_area m
		LEFT JOIN tb_area n ON m.SUPER_AREA_CODE = n.AREA_CODE
        ORDER BY m.`LEVEL`,m.SEQ_NO
	</select>
	

</mapper>
